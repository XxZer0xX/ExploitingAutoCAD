#region Referenceing

using System.Diagnostics;
using System.Linq;
using Autodesk.AutoCAD.ApplicationServices;
using Autodesk.AutoCAD.DatabaseServices;
using Autodesk.AutoCAD.Runtime;

#endregion

namespace GetObjectsFromModelspaceByType
{
    public class RunMetrics
    {
        [CommandMethod("Exploit")]
        public void Execute()
        {
            var sw = new Stopwatch();
            var doc = Application.DocumentManager.MdiActiveDocument;
            sw.Start();
            var ids = IterationExample.GetIdsByTypeIteration(typeof (Polyline), typeof (Polyline2d), typeof (Polyline3d));
            sw.Stop();
            reportMetrics("Iteration", doc, sw.ElapsedTicks, ids.Count(), sw.ElapsedMilliseconds);
            sw.Reset();
            sw.Start();
            var idss = TypedValueExample.GetIdsByTypeTypeValue("POLYLINE", "LWPOLYLINE", "POLYLINE2D", "POLYLINE3d");
            sw.Stop();
            reportMetrics("TypedValue", doc, sw.ElapsedTicks, idss.Count, sw.ElapsedMilliseconds);
        }

        private void reportMetrics(string version, Document doc, long elapsed, int objCount, long time)
        {
            var metrics = string.Format("{3}:\n\tticks: {0}\n\ttime: {2}ms \n\tSelected Ids Count = {1}\n\t", elapsed,
                objCount, time, version);

            doc.Editor.WriteMessage(string.Format("\n\n{0}", metrics));
        }
    }
}